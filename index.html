<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Genome Reassembly Tool</title>
    <link rel="stylesheet" href="style.css">
    <link rel="icon" href="favicon.ico">
</head>
<body>
    <div class="app-container">
        <header class="header">
            <h1>üß¨ Genome Reassembly Tool</h1>
        </header>

        <nav class="tab-nav">
            <button class="tab-btn active" data-tab="data">üìä Data Input</button>
            <button class="tab-btn" data-tab="viz">üî¨ Visualization & Editing</button>
            <button class="tab-btn" data-tab="export">üíæ Export</button>
        </nav>

        <!-- Data Input Tab -->
        <div class="tab-content active" id="data-tab">
            <div class="data-tab">
                <div class="data-grid">
                    <div class="data-panel">
                        <h2>Reference Genome (FASTA)</h2>
                        <div class="input-tabs">
                            <button class="input-tab-btn active" data-input="fasta-upload">Upload</button>
                            <button class="input-tab-btn" data-input="fasta-paste">Paste</button>
                            <button class="input-tab-btn" data-input="fasta-url">URL</button>
                            <button class="input-tab-btn" data-input="fasta-demo">Demo</button>
                        </div>
                        <div class="input-content active" id="fasta-upload">
                            <div class="file-input-wrapper">
                                <input type="file" id="fasta-file" class="file-input" accept=".fasta,.fa,.fna,.txt">
                                <label for="fasta-file" class="file-label">
                                    <div>üìÅ Choose FASTA file</div>
                                    <div style="font-size: 0.9rem; color: var(--text-tertiary); margin-top: 0.5rem;">or drag and drop here</div>
                                </label>
                            </div>
                        </div>
                        <div class="input-content" id="fasta-paste">
                            <textarea class="textarea-input" placeholder="Paste FASTA content here..."></textarea>
                        </div>
                        <div class="input-content" id="fasta-url">
                            <div class="url-input-group">
                                <input type="url" class="url-input" placeholder="Enter FASTA URL...">
                                <button class="btn">Fetch</button>
                            </div>
                        </div>
                        <div class="input-content" id="fasta-demo">
                            <button class="btn demo-btn">Load Demo Genome</button>
                        </div>
                    </div>

                    <div class="data-panel">
                        <h2>Contact Map (BED/Matrix)</h2>
                        <div class="input-tabs">
                            <button class="input-tab-btn active" data-input="bed-upload">Upload</button>
                            <button class="input-tab-btn" data-input="bed-paste">Paste</button>
                            <button class="input-tab-btn" data-input="bed-url">URL</button>
                            <button class="input-tab-btn" data-input="bed-demo">Demo</button>
                        </div>
                        <div class="input-content active" id="bed-upload">
                            <div class="file-input-wrapper">
                                <input type="file" id="bed-file" class="file-input" accept=".bed,.txt,.gz,.zip">
                                <label for="bed-file" class="file-label">
                                    <div>üìä Choose BED/Matrix file</div>
                                    <div style="font-size: 0.9rem; color: var(--text-tertiary); margin-top: 0.5rem;">or drag and drop here</div>
                                </label>
                            </div>
                        </div>
                        <div class="input-content" id="bed-paste">
                            <textarea class="textarea-input" placeholder="Paste BED/Matrix content here..."></textarea>
                        </div>
                        <div class="input-content" id="bed-url">
                            <div class="url-input-group">
                                <input type="url" class="url-input" placeholder="Enter BED/Matrix URL...">
                                <button class="btn">Fetch</button>
                            </div>
                        </div>
                        <div class="input-content" id="bed-demo">
                            <button class="btn demo-btn">Load Demo Contact Map</button>
                        </div>
                    </div>

                    <div class="process-section">
                        <div class="status-bar">
                            <div class="status-item" id="fasta-status">
                                <span class="status-icon">‚ö™</span>
                                <span>FASTA: Not loaded</span>
                            </div>
                            <div class="status-item" id="bed-status">
                                <span class="status-icon">‚ö™</span>
                                <span>Contact Map: Not loaded</span>
                            </div>
                        </div>
                        <button class="btn process-btn" id="process-btn">üöÄ Process Data</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Visualization Tab -->
        <div class="tab-content" id="viz-tab">
            <div class="viz-tab">
                <aside class="viz-sidebar">
                    <div class="sidebar-tabs">
                        <button class="sidebar-tab active" data-sidebar="tools">Tools</button>
                        <button class="sidebar-tab" data-sidebar="history">History</button>
                        <button class="sidebar-tab" data-sidebar="settings">Settings</button>
                    </div>
                    
                    <div class="sidebar-content">
                        <!-- Tools Panel -->
                        <div class="sidebar-panel active" id="tools-panel">
                            <div class="sidebar-section">
                                <h3>Editing Tools</h3>
                                <div class="tool-grid">
                                    <button class="tool-btn active" data-tool="select">
                                        <span class="tool-icon">‚¨ö</span>
                                        <span class="tool-name">Select</span>
                                    </button>
                                    <button class="tool-btn" data-tool="move">
                                        <span class="tool-icon">‚ÜîÔ∏è</span>
                                        <span class="tool-name">Move</span>
                                    </button>
                                    <button class="tool-btn" data-tool="invert">
                                        <span class="tool-icon">üîÑ</span>
                                        <span class="tool-name">Invert</span>
                                    </button>
                                    <button class="tool-btn" data-tool="delete">
                                        <span class="tool-icon">üóëÔ∏è</span>
                                        <span class="tool-name">Delete</span>
                                    </button>
                                    <button class="tool-btn" data-tool="duplicate">
                                        <span class="tool-icon">üìã</span>
                                        <span class="tool-name">Duplicate</span>
                                    </button>
                                    <button class="tool-btn" data-tool="split">
                                        <span class="tool-icon">‚úÇÔ∏è</span>
                                        <span class="tool-name">Split</span>
                                    </button>
                                    <button class="tool-btn" data-tool="fuse">
                                        <span class="tool-icon">üîó</span>
                                        <span class="tool-name">Fuse</span>
                                    </button>
                                    <button class="tool-btn" data-tool="swap">
                                        <span class="tool-icon">üîÄ</span>
                                        <span class="tool-name">Swap</span>
                                    </button>
                                </div>
                            </div>

                            <div class="sidebar-section">
                                <h3>Selected Region</h3>
                                <div class="region-info" id="region-info">
                                    <p style="color: var(--text-tertiary);">No region selected</p>
                                </div>
                                <div class="operation-controls" id="operation-controls" style="display: none;">
                                    <button class="btn control-btn confirm" id="confirm-op">‚úì Confirm</button>
                                    <button class="btn control-btn cancel" id="cancel-op">‚úó Cancel</button>
                                    <button class="btn control-btn reset" id="reset-op">‚Ü∫ Reset</button>
                                </div>
                            </div>
                        </div>

                        <!-- History Panel -->
                        <div class="sidebar-panel" id="history-panel" style="display: none;">
                            <div class="sidebar-section">
                                <h3>Edit History</h3>
                                <div class="history-list" id="history-list">
                                    <!-- History items will be added here -->
                                </div>
                            </div>
                        </div>

                        <!-- Settings Panel -->
                        <div class="sidebar-panel" id="settings-panel" style="display: none;">
                            <div class="sidebar-section">
                                <h3>Visualization Settings</h3>
                                
                                <div class="settings-group">
                                    <label>Transform</label>
                                    <select id="transform-select">
                                        <option value="linear">Linear</option>
                                        <option value="log" selected>Log</option>
                                        <option value="log2">Log2</option>
                                        <option value="sqrt">Square Root</option>
                                    </select>
                                </div>

                                <div class="settings-group">
                                    <label>Color Scheme</label>
                                    <select id="colorscheme-select">
                                        <option value="viridis">Viridis</option>
                                        <option value="plasma">Plasma</option>
                                        <option value="inferno">Inferno</option>
                                        <option value="turbo" selected>Turbo</option>
                                        <option value="hot">Hot</option>
                                        <option value="cool">Cool</option>
                                    </select>
                                </div>

                                <div class="settings-group">
                                    <label>Min Value: <span id="vmin-label">0</span></label>
                                    <input type="range" id="vmin-slider" min="0" max="100" value="0">
                                </div>

                                <div class="settings-group">
                                    <label>Max Value: <span id="vmax-label">100</span></label>
                                    <input type="range" id="vmax-slider" min="1" max="1000" value="100">
                                </div>

                                <div class="settings-group">
                                    <div class="checkbox-group">
                                        <input type="checkbox" id="percentile-clip">
                                        <label for="percentile-clip">Auto clip (95th percentile)</label>
                                    </div>
                                </div>

                                <div class="settings-group">
                                    <div class="checkbox-group">
                                        <input type="checkbox" id="grid-toggle" checked>
                                        <label for="grid-toggle">Show chromosome boundaries</label>
                                    </div>
                                </div>

                                <div class="settings-group">
                                    <div class="checkbox-group">
                                        <input type="checkbox" id="diagonal-toggle">
                                        <label for="diagonal-toggle">Show diagonal</label>
                                    </div>
                                </div>

                                <div class="settings-group">
                                    <label>Gamma: <span id="gamma-label">1.0</span></label>
                                    <input type="range" id="gamma-slider" min="0.1" max="3.0" step="0.1" value="1.0">
                                </div>

                                <div class="settings-group">
                                    <label>Min Chromosome Size: <span id="min-chr-label">10</span> bins</label>
                                    <input type="range" id="min-chr-size" min="1" max="50" value="10">
                                </div>

                                <button class="btn" id="apply-settings" style="width: 100%; margin-top: 1rem;">Apply Settings</button>
                            </div>
                        </div>
                    </div>
                </aside>

                <main class="viz-main">
                    <div class="viz-header">
                        <h2>Contact Map Visualization</h2>
                        <div class="score-display">
                            <div class="score-item">
                                <div class="score-label">Current Score</div>
                                <div class="score-value" id="current-score">0.00</div>
                            </div>
                            <div class="score-item">
                                <div class="score-label">Best Score</div>
                                <div class="score-value" id="best-score" style="color: var(--accent);">0.00</div>
                            </div>
                            <div class="score-item">
                                <div class="score-label">Alpha</div>
                                <div class="score-value" id="alpha-value" style="color: var(--warning);">-1.00</div>
                            </div>
                        </div>
                    </div>

                    <div class="viz-container">
                        <div class="heatmap-panel">
                            <div class="heatmap-wrapper">
                                <canvas id="heatmap-canvas"></canvas>
                                <div class="selection-overlay" id="selection-overlay"></div>
                                <div class="hover-info" id="hover-info">
                                    <div class="hover-coords"></div>
                                    <div class="hover-value"></div>
                                </div>
                            </div>
                        </div>

                        <div class="ps-panel">
                            <h3>P(s) Distribution</h3>
                            <canvas id="ps-plot"></canvas>
                            <div style="text-align: center; margin-top: 1rem; font-family: 'Consolas', monospace;">
                                P(s) ~ s<sup id="ps-alpha">-1.0</sup>
                            </div>
                        </div>
                    </div>
                </main>
            </div>
        </div>

        <!-- Export Tab -->
        <div class="tab-content" id="export-tab">
            <div class="export-tab">
                <div class="export-section">
                    <h2>Export Options</h2>
                    <div class="export-grid">
                        <button class="export-btn" id="export-bed">
                            <span class="export-icon">üìä</span>
                            <span>Export BED</span>
                        </button>
                        <button class="export-btn" id="export-modifications">
                            <span class="export-icon">üìù</span>
                            <span>Export Modifications</span>
                        </button>
                        <button class="export-btn" id="export-fasta">
                            <span class="export-icon">üß¨</span>
                            <span>Export FASTA</span>
                        </button>
                        <button class="export-btn" id="export-matrix">
                            <span class="export-icon">üî¢</span>
                            <span>Export Matrix</span>
                        </button>
                    </div>
                </div>

                <div class="export-section">
                    <h2>Summary Statistics</h2>
                    <div id="export-summary">
                        <p style="color: var(--text-tertiary);">No data processed yet</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="loading-overlay" id="loading" style="display: none;">
        <div class="loading-spinner"></div>
    </div>

    <script src="script.js"></script>
</body>
</html>